(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{259:function(t,s,a){"use strict";a.r(s);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},o=a(5),v=Object(o.a)(n,function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[a("h1",{attrs:{id:"class装饰器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#class装饰器","aria-hidden":"true"}},[t._v("#")]),t._v(" Class装饰器")]),t._v(" "),a("p",[t._v("wxa基于最新的"),a("a",{attrs:{href:"https://github.com/tc39/proposal-decorators/blob/master/METAPROGRAMMING.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("proposal-decorators"),a("OutboundLink")],1),t._v(", 编写了丰富的类装饰器。通过拦截，改写等方式，对类进行增强。")]),t._v(" "),a("p",[t._v("大部分类装饰器，都提供了单独调用的方法，譬如对应缓存操作，wxa有装饰器"),a("code",[t._v("Storage")]),t._v("和单独的"),a("code",[t._v("storage")]),t._v("对象。")]),t._v(" "),a("p",[t._v("Decorators方式如下:")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Storage"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),t._v("\n\n@Storage\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Index")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$storage"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'MSG'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("直接使用:")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("storage"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" abc "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" storage"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'abc'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("类装饰器新增的方法一般都一"),a("code",[t._v("$")]),t._v("开头哟~，譬如"),a("code",[t._v("$diff")]),t._v(", "),a("code",[t._v("$storage")]),t._v("，"),a("code",[t._v("$router")]),t._v("等等，这一点与"),a("code",[t._v("@wxa/core@1.x")]),t._v("不一致。")])]),t._v(" "),a("p",[t._v("由于在实际项目开发中，一般都会用到很多好用的Decorator，于是在其他类装饰器的基础上，wxa又包装了"),a("code",[t._v("App")]),t._v("和"),a("code",[t._v("Page")]),t._v("装饰器，以满足日常开发需要。")]),t._v(" "),a("h2",{attrs:{id:"app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#app","aria-hidden":"true"}},[t._v("#")]),t._v(" App")]),t._v(" "),a("p",[t._v("App装饰器是"),a("code",[t._v("Utils")]),t._v(", "),a("code",[t._v("Storage")]),t._v(", "),a("code",[t._v("Wxapi")]),t._v(", "),a("code",[t._v("Router")]),t._v(", "),a("code",[t._v("Eventbus")]),t._v(", "),a("code",[t._v("Fetch")]),t._v("的集合。使用了App装饰器等于同时使用了上述所有功能装饰器。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("@App\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Main")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{attrs:{class:"token comment"}},[t._v("// 使用fetch获取数据")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("$fetch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'https://remote/server'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{attrs:{class:"token comment"}},[t._v("// 使用router方法跳转路由")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/pages/log/log'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("error")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("boo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 触发一个something happened的事件。")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("emit")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'somthing happened'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Hey Guys!'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"page"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#page","aria-hidden":"true"}},[t._v("#")]),t._v(" Page")]),t._v(" "),a("p",[t._v("Page装饰器是"),a("code",[t._v("Utils")]),t._v(", "),a("code",[t._v("Storage")]),t._v(", "),a("code",[t._v("Wxapi")]),t._v(", "),a("code",[t._v("Router")]),t._v(", "),a("code",[t._v("Eventbus")]),t._v(", "),a("code",[t._v("Fetch")]),t._v("的集合。使用了Page装饰器等于同时使用了上述所有功能装饰器。")]),t._v(" "),a("p",[t._v("另外，"),a("code",[t._v("Page")]),t._v("装饰器还是自动注入app实例到"),a("code",[t._v("$app")]),t._v("上。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("@Page\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Index")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 获取app实例")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$app"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isDEBUG"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setData")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                name"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),t._v("\n            "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{attrs:{class:"token comment"}},[t._v("//获取远程数据")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("$fetch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'remote/server'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"eventbus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eventbus","aria-hidden":"true"}},[t._v("#")]),t._v(" Eventbus")]),t._v(" "),a("p",[t._v("在小程序中，跨页面，跨组件的共享状态是一个比较难以解决的问题，全局状态管理方案"),a("code",[t._v("@wxa/Redux")]),t._v("可以优雅的解决该问题，除"),a("code",[t._v("redux")]),t._v("方案之外，wxa还提供了一个简易的自定义事件管理，允许开发者快速开发跨页面，跨组件的业务需求。")]),t._v(" "),a("p",[t._v("简单示例如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n@Eventbus\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("APage")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("boo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 监听一个事件")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("on")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'event'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("// b.js")]),t._v("\n@Eventbus\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("BPage")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("onShow")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 触发事件")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("emit")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'event'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"on-name-handler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#on-name-handler","aria-hidden":"true"}},[t._v("#")]),t._v(" on( name, handler )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("name")]),t._v(": "),a("code",[t._v("String")]),t._v(" 监听的自定义事件名")]),t._v(" "),a("li",[a("strong",[t._v("handler")]),t._v(": "),a("code",[t._v("Function")]),t._v(" 回调函数")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("监听一个自定义事件，当事件触发的时候执行对应回调函数。")]),t._v(" "),a("h3",{attrs:{id:"off-name-handler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#off-name-handler","aria-hidden":"true"}},[t._v("#")]),t._v(" off( name, handler )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("name")]),t._v(": "),a("code",[t._v("String")]),t._v(" 监听的自定义事件名")]),t._v(" "),a("li",[a("strong",[t._v("handler")]),t._v(": "),a("code",[t._v("Function")]),t._v(" 对应回调函数")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("取消监听一个自定义事件。")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("在页面被注销的时候记得取消监听事件，避免内存泄漏！")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("@Page \n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Idx")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("onLoad")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("on")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'e'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("onUnload")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("off")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'e'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("handler")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("h3",{attrs:{id:"emit-name-payload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#emit-name-payload","aria-hidden":"true"}},[t._v("#")]),t._v(" emit( name, payload )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("name")]),t._v(": "),a("code",[t._v("String")]),t._v(" 监听的自定义事件名")]),t._v(" "),a("li",[a("strong",[t._v("payload")]),t._v(": "),a("code",[t._v("[Object, String, Number]")]),t._v(" 回调函数接受的参数")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("触发一个自定义事件")]),t._v(" "),a("h3",{attrs:{id:"clear-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clear-name","aria-hidden":"true"}},[t._v("#")]),t._v(" clear( name )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("name")]),t._v(": "),a("code",[t._v("[String, Null]")]),t._v(" 监听的自定义事件名")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 注意这么写会清空所有事件")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("clear")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{attrs:{class:"token comment"}},[t._v("// 清楚所有event事件监听")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$eventbus"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("clear")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'event'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),a("p",[t._v("清空指定事件回调，或者清空所有事件回调")]),t._v(" "),a("h2",{attrs:{id:"fetch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fetch","aria-hidden":"true"}},[t._v("#")]),t._v(" Fetch")]),t._v(" "),a("p",[a("code",[t._v("wxa")]),t._v("为网络请求提供了一个好用的"),a("code",[t._v("Fetch")]),t._v("装饰器，通过"),a("code",[t._v("fetch")]),t._v("，开发者可以快速的发起请求，而不需要担心"),a("code",[t._v("wx.request")]),t._v("引发的其他问题。")]),t._v(" "),a("p",[a("code",[t._v("fetch")]),t._v("api具有promise化，队列化请求的能力，同时具备对"),a("code",[t._v("post")]),t._v("请求的短时间防重。")]),t._v(" "),a("h3",{attrs:{id:"fetch-url-data-configs-method"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fetch-url-data-configs-method","aria-hidden":"true"}},[t._v("#")]),t._v(" fetch( url, data, configs, method )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("url")]),t._v(": "),a("code",[t._v("String")]),t._v(" 接口地址")]),t._v(" "),a("li",[a("strong",[t._v("data")]),t._v(": "),a("code",[t._v("Object")]),t._v(" 请求携带的数据")]),t._v(" "),a("li",[a("strong",[t._v("configs")]),t._v(": "),a("code",[t._v("Object")]),t._v(" 请求的配置\n"),a("ul",[a("li",[a("strong",[t._v("$top")]),t._v(": "),a("code",[t._v("Boolean")]),t._v(" 高优先级请求，直接压入等待队列的列首")]),t._v(" "),a("li",[a("strong",[t._v("$noCache")]),t._v(": "),a("code",[t._v("Boolean")]),t._v(" 指定该请求不做防重处理")]),t._v(" "),a("li",[t._v("其他小程序默认的配置都放在这里，例如header，dataType，具体参数可以参考"),a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序文档"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("strong",[t._v("method")]),t._v(": "),a("code",[t._v("String")]),t._v(" 请求方式, get, post。")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("@Fetch\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("UserInfo")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" succ "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("$fetch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/remote/user/get'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'get'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// other logic")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"mixins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mixins","aria-hidden":"true"}},[t._v("#")]),t._v(" Mixins")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("调用方式")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("@Mixins( [mixin]+ )")])])])]),t._v(" "),a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("mixin")]),t._v(" 混合对象，可以为Object或者Class。")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("混合多个对象或Class的方法，数据，生命周期到当前App/页面/组件类。data将会做一次deep merge，方法按顺序覆盖，生命周期函数则按顺序执行。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参考")]),t._v(":")])]),t._v(" "),a("p",[t._v("指南：对象混合")]),t._v(" "),a("h2",{attrs:{id:"router"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#router","aria-hidden":"true"}},[t._v("#")]),t._v(" Router")]),t._v(" "),a("p",[t._v("简洁的路由API，用于跳转小程序路由页面。")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("Router")]),t._v("提供的路由方法跳转，可以享受wxa提供的预加载特性，具体请查看生命周期"),a("code",[t._v("beforeRouteEnter")]),t._v("文档。")])]),t._v(" "),a("h3",{attrs:{id:"get"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get","aria-hidden":"true"}},[t._v("#")]),t._v(" get( )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// {_webviewid: 1, route: 'pages/index/index', ...}")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" currentPage "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),a("p",[t._v("获取当前路由页面信息")]),t._v(" "),a("h3",{attrs:{id:"getall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getall","aria-hidden":"true"}},[t._v("#")]),t._v(" getAll( )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 获取完整的页面栈")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" stack "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getAll")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("获取当前路由栈，相当于调用了小程序的"),a("code",[t._v("getCurrentPages()")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"push-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#push-path","aria-hidden":"true"}},[t._v("#")]),t._v(" push( path )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("path")]),t._v(": "),a("code",[t._v("String")]),t._v(" 页面路由路径，相对路径或绝对路径")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 直接跳转")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/pages/index'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 跳转完成后做一些特殊处理")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("push")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'/pages/index'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$storage"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'hasTravel'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("toast")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'跳转失败'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("跳转到新路由页面，入栈路由。")]),t._v(" "),a("h3",{attrs:{id:"replace-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replace-path","aria-hidden":"true"}},[t._v("#")]),t._v(" replace( path )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("path")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("关闭当前页面，打开新的指定页面。")]),t._v(" "),a("h3",{attrs:{id:"relaunch-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#relaunch-path","aria-hidden":"true"}},[t._v("#")]),t._v(" reLaunch( path )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("path")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("关闭所有页面栈中的页面，重新打开指定页面。")]),t._v(" "),a("h3",{attrs:{id:"switch-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#switch-path","aria-hidden":"true"}},[t._v("#")]),t._v(" switch( path )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("path")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("切换tabar页面。")]),t._v(" "),a("h3",{attrs:{id:"go-delta"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go-delta","aria-hidden":"true"}},[t._v("#")]),t._v(" go( delta )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("delta")]),t._v(": "),a("code",[t._v("Number")]),t._v(" 回退的页面数")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("回退页面, delta为欲回退页面数。")]),t._v(" "),a("h3",{attrs:{id:"goback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#goback","aria-hidden":"true"}},[t._v("#")]),t._v(" goBack( )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("回退上一个页面，相当于调用"),a("code",[t._v("this.$router.go(-1)")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"close"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#close","aria-hidden":"true"}},[t._v("#")]),t._v(" close( )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("关闭小程序。")]),t._v(" "),a("p",[t._v("⚠️谨慎调用，将会直接关闭小程序。")]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),a("p",[a("code",[t._v("this.$router.close()")]),t._v("方法不保证未来小程序官方会不会封禁，建议减少使用。")])]),t._v(" "),a("h2",{attrs:{id:"storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storage","aria-hidden":"true"}},[t._v("#")]),t._v(" Storage")]),t._v(" "),a("p",[t._v("缓存操作。挂载于"),a("code",[t._v("this.$storge")]),t._v(", storage方法包装了同步的"),a("code",[t._v("wx.storage")]),t._v("方法，提供简洁api。")]),t._v(" "),a("p",[t._v("值得一提的是，storage缓存的数据会做一次"),a("code",[t._v("JSON.stringify")]),t._v("操作，在读取数据的时候再做相应的"),a("code",[t._v("JSON.parse")]),t._v("后返回。故而storage可以直接缓存非"),a("code",[t._v("Primitive Type")]),t._v("的数据，当然函数除外~")]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("storage并不能存"),a("code",[t._v("Function")]),t._v("类型的数据或带有循环引用的对象。")]),t._v(" "),a("p",[t._v("缓存的数据在删除小程序后会丢失。")])]),t._v(" "),a("p",[t._v("示例代码：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// Storage Decorator")]),t._v("\n@Storage\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Center")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("travel")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$storage"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'keyOfValue'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"set-key-value"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-key-value","aria-hidden":"true"}},[t._v("#")]),t._v(" set( key, value )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(":\n"),a("ul",[a("li",[a("strong",[t._v("key")]),t._v(": "),a("code",[t._v("String")])]),t._v(" "),a("li",[a("strong",[t._v("value")]),t._v(": "),a("code",[t._v("Any")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("同步的缓存数据到storage。")]),t._v(" "),a("h3",{attrs:{id:"get-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-key","aria-hidden":"true"}},[t._v("#")]),t._v(" get( key )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" :\n"),a("ul",[a("li",[a("strong",[t._v("key")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("同步的获取缓存数据。")]),t._v(" "),a("h3",{attrs:{id:"remove-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove-key","aria-hidden":"true"}},[t._v("#")]),t._v(" remove( key )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" :\n"),a("ul",[a("li",[a("strong",[t._v("key")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("清除指定key的缓存数据。")]),t._v(" "),a("h3",{attrs:{id:"clear"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clear","aria-hidden":"true"}},[t._v("#")]),t._v(" clear( )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("p",[t._v("⚠️清除所有的缓存数据。")]),t._v(" "),a("h2",{attrs:{id:"utils"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#utils","aria-hidden":"true"}},[t._v("#")]),t._v(" Utils")]),t._v(" "),a("p",[t._v("工具函数集")]),t._v(" "),a("h3",{attrs:{id:"formatdate-timestap-format"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#formatdate-timestap-format","aria-hidden":"true"}},[t._v("#")]),t._v(" formatDate( timestap, format )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("timestap")]),t._v(": "),a("code",[t._v("[Number, String]")])]),t._v(" "),a("li",[a("strong",[t._v("format")]),t._v(": "),a("code",[t._v("String")]),t._v(" 格式化后的时间格式，默认"),a("code",[t._v("'yyyy-MM-dd hh:mm:ss'")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dateStr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$utils"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("formatDate")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("now")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("格式化时间戳为指定格式的字符串")]),t._v(" "),a("h3",{attrs:{id:"trim-str"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#trim-str","aria-hidden":"true"}},[t._v("#")]),t._v(" trim( str )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("str")]),t._v(": "),a("code",[t._v("String")])])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" trimStr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$utils"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("trim")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("由于小程序部分终端不支持"),a("code",[t._v(".trim")]),t._v("方法，所以wxa提供了一个补丁方法。")]),t._v(" "),a("h3",{attrs:{id:"compareversion-v1-v2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compareversion-v1-v2","aria-hidden":"true"}},[t._v("#")]),t._v(" compareVersion( v1, v2 )")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("参数")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("v1")]),t._v(": "),a("code",[t._v("String")]),t._v(" version")]),t._v(" "),a("li",[a("strong",[t._v("v2")]),t._v(": "),a("code",[t._v("String")]),t._v(" version")])])]),t._v(" "),a("li",[a("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("compareVersion")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'1.2.1'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'1.1.0'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("compareVersion")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'2.0.7'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'2.2.0'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// -1")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("compareVersion")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'1.1.0'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'1.1.0'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// 0")]),t._v("\n")])])]),a("p",[t._v("小程序官方提供的基础库比较函数。如果v1等于v2则返回0，v1大于v2则返回1，v1小于v2则返回-1。")]),t._v(" "),a("h2",{attrs:{id:"wxapi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wxapi","aria-hidden":"true"}},[t._v("#")]),t._v(" Wxapi")]),t._v(" "),a("p",[t._v("尝试对所有"),a("code",[t._v("wx.*")]),t._v("的方法做一次"),a("code",[t._v("promisify")]),t._v("操作，返回一个异步的小程序函数。开发者可以直接使用promise处理异步问题，也可以搭配"),a("code",[t._v("Async/Await")]),t._v("使用。示例如下：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 获取地理位置")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("latitude"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" longtitude"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$wxapi"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getLocation")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'wgs84'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 扫一扫")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$wxapi"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("scanCode")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 登录接口")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("code"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$wxapi"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("login")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("对于同步的方法，不做任何包装直接返回函数执行结果：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 同步获取手机信息")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$wxapi"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getSystemInfoSync")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 同步获取小程序更新器句柄")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" manager "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$wxapi"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getUpdateManager")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("wxapi对所有微信api一次promise化。其中不会做promisify的方法有："),a("code",[t._v("create*")]),t._v("方法，"),a("code",[t._v("on*")]),t._v("， "),a("code",[t._v("*Sync")]),t._v("方法和"),a("code",[t._v("getUpdateManager")]),t._v("方法。")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("wxa.addNoPromiseApi")]),t._v("可以手动添加方法，避免被方法被错误的promise化")])])])},[],!1,null,null,null);v.options.__file="class.md";s.default=v.exports}}]);