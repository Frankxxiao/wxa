(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{229:function(t,a,s){"use strict";s.r(a);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},o=s(5),v=Object(o.a)(n,function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[s("h1",{attrs:{id:"全局api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局api","aria-hidden":"true"}},[t._v("#")]),t._v(" 全局API")]),t._v(" "),s("h2",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("h3",{attrs:{id:"wxa-setmaxrequest-number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-setmaxrequest-number","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.setMaxRequest( number )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("number")]),t._v(" "),s("code",[t._v("Number")]),t._v(" "),s("strong",[t._v("Default")]),t._v(": 5")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// app.js")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 最大并发4个请求，多余请求在队列排队等待")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("setMaxRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token number"}},[t._v("4")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("设置最多同时并发的网络请求。")]),t._v(" "),s("p",[t._v("微信"),s("code",[t._v("wx.request")]),t._v("接口最多同时并发10个请求，超过10个请求将会被抛弃。wxa提供了一层request包装，引入队列控制并发请求。小程序业务层可以不关心并发多少个请求的问题，wxa将会保证每个请求都发出去。")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("最大并发请求不应该设置超过10"),s("br"),t._v("\n超过最大并发的请求都会在队列等待其他请求完成后按顺序发出")])]),t._v(" "),s("h3",{attrs:{id:"wxa-setrequestexpiredtime-ms"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-setrequestexpiredtime-ms","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.setRequestExpiredTime( ms )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("ms")]),t._v(": "),s("code",[t._v("Number")]),t._v(" 毫秒 "),s("strong",[t._v("Default")]),t._v(": 500ms")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// app.js")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),t._v("\n\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("setRequestExpiredTime")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token number"}},[t._v("1000")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("设置post请求失效缓存失效时间。")]),t._v(" "),s("p",[t._v("使用wxa的"),s("code",[t._v("fetch")]),t._v("方法发送网络请求，wxa会缓存每个post请求，当客户端在一定时间内连续发送同一个请求的时候，wxa会主动reject并返回"),s("code",[t._v("{code: -101}")]),t._v("。相当于做一层前端post请求防重复。")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("wxa的前端防重机制大部分时间下可以很好的处理绝大多数请求重复的case。但是如果业务比较复杂，例如遇到多异步请求的事务性业务的时候，http层的请求防重并不能解决问题，wxa另外提供了一个"),s("code",[t._v("Lock")]),t._v("装饰器来处理这种情况。")])]),t._v(" "),s("h3",{attrs:{id:"wxa-addnopromiseapi-name"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-addnopromiseapi-name","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.addNoPromiseApi( name )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("name")]),t._v(": "),s("code",[t._v("[String, Array]")])])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),t._v("\n\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addNoPromiseApi")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'getRecorderManager'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addNoPromiseApi")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token string"}},[t._v("'uploadFile'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'nextTick'")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("wxa尝试为所有"),s("code",[t._v("wx.**")]),t._v("的方法做一次promise化，但是有一些同步的api却不应该这么做，因为他们会直接返回某个句柄或者结果值，如果为他们做了promise化，这些返回将会被损失。")]),t._v(" "),s("h3",{attrs:{id:"wxa-setdebugmode-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-setdebugmode-mode","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.setDebugMode( mode )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("mode")]),t._v(": "),s("code",[t._v("false")])])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("setDebugMode")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("debug模式，wxa会打印更详细的debug信息用于调试，项目上线后请关闭该选项。")]),t._v(" "),s("h2",{attrs:{id:"注册"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册","aria-hidden":"true"}},[t._v("#")]),t._v(" 注册")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("使用@wxa/cli2可以不需要手动调用这些注册，直接导出对应类即可，cli会通过注入脚本，自动调用该方法。\n示例：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// app.wxa 使用cli2编译项目")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("App"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n@App\n"),s("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// your logic here.")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("h3",{attrs:{id:"wxa-launchapp-instance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-launchapp-instance","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.launchApp( instance )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("instance")]),t._v(" "),s("code",[t._v("[Object, Array]")]),t._v(" 小程序App类或者对象实例")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// app.js / app.wxa")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 传递一个App对象")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("launchApp")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    globalData"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        userInfo"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// 小程序生命周期函数")]),t._v("\n    "),s("span",{attrs:{class:"token function"}},[t._v("onLaunch")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 传递一个App类")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("launchApp")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    globalData "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        userInfo"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            userInfo"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),t._v("\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// 小程序生命周期函数")]),t._v("\n    "),s("span",{attrs:{class:"token function"}},[t._v("onLaunch")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注册一个小程序，接受一个类或对象实例，相当于小程序原生开发中显式调用"),s("code",[t._v("App()")]),t._v("。")]),t._v(" "),s("p",[s("code",[t._v("wxa.launchApp")]),t._v("会在内部调用"),s("code",[t._v("App()")]),t._v("函数，并在这之前对实例进行"),s("code",[t._v("mixins")]),t._v("处理和插件应用。")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("最佳实践是传递一个类，这样可以享受wxa提供的Decorator的便利。")])]),t._v(" "),s("h3",{attrs:{id:"wxa-launchpage-instance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-launchpage-instance","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.launchPage( instance )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("instance")]),t._v(" "),s("code",[t._v("[Object, Array]")]),t._v(" 小程序页面类或对象实例")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// index.js / index.wxa")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 传递一个App类")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("launchPage")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Index")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        data "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 小程序生命周期函数")]),t._v("\n        "),s("span",{attrs:{class:"token function"}},[t._v("onLoad")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 页面事件响应函数")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("tap")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),s("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("1000")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注册一个小程序页面，接受一个类或对象实例，相当于小程序原生开发中显式调用"),s("code",[t._v("Page()")]),t._v("。")]),t._v(" "),s("p",[s("code",[t._v("wxa.launchPage")]),t._v("会为加载全局和局部"),s("code",[t._v("mixins")]),t._v("、添加"),s("code",[t._v("$go")]),t._v("和"),s("code",[t._v("$diff")]),t._v("函数到页面实例，最后应用插件到实例。")]),t._v(" "),s("h3",{attrs:{id:"wxa-launchcomponent-instance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-launchcomponent-instance","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.launchComponent( instance )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("instance")]),t._v(" "),s("code",[t._v("[Object, Array]")]),t._v(" 小程序自定义组件类或对象实例")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// index.js / index.wxa")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 传递一个App类")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("launchComponent")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Popup")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        properties "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            text"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        data "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'Genuifx'")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 小程序组件生命周期函数")]),t._v("\n        "),s("span",{attrs:{class:"token function"}},[t._v("attached")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 组件事件响应函数")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("tap")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),s("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("1000")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注册一个小程序自定义组件，接受一个类或对象实例，相当于小程序原生开发中显式调用"),s("code",[t._v("Component()")]),t._v("。")]),t._v(" "),s("p",[s("code",[t._v("wxa.launchComponent")]),t._v("会为加载全局和局部"),s("code",[t._v("mixins")]),t._v("、添加"),s("code",[t._v("$diff")]),t._v("函数到页面实例，最后应用插件到实例。")]),t._v(" "),s("h2",{attrs:{id:"混合和插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#混合和插件","aria-hidden":"true"}},[t._v("#")]),t._v(" 混合和插件")]),t._v(" "),s("h3",{attrs:{id:"wxa-mixin-mixin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-mixin-mixin","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.mixin( mixin )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("mixin")]),t._v(": "),s("code",[t._v("[Class, Object]")])])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("p",[t._v("添加一个全局mixin，所有页面实例和自定义组件实例都应用到。一般用于挂载项目中常用的函数方法到页面。")]),t._v(" "),s("h3",{attrs:{id:"wxa-use-plugin-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxa-use-plugin-options","aria-hidden":"true"}},[t._v("#")]),t._v(" wxa.use( plugin, options )")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("参数")]),t._v(":\n"),s("ul",[s("li",[s("strong",[t._v("plugin")]),t._v(": "),s("code",[t._v("Function")]),t._v(" 一个高级函数")]),t._v(" "),s("li",[s("strong",[t._v("options")]),t._v(": "),s("code",[t._v("Object")]),t._v(" 传递给插件的参数")])])]),t._v(" "),s("li",[s("strong",[t._v("用例")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// app.js")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("wxa"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/core'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" watchPlugin "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'@wxa/watch'")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 挂载插件")]),t._v("\nwxa"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("use")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watchPlugin"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// index.js")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Index")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    data"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        formData"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("''")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    watch "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// 监听formData.name的变化")]),t._v("\n        "),s("span",{attrs:{class:"token string"}},[t._v("'formData.name'")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldValue"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("setData")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                valid"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("!")]),s("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("newValue\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("添加一个插件，该插件可以应用到App实例、页面实例和自定义组件实例。插件一般用于实现特定的通用功能，比如"),s("code",[t._v("watch")]),t._v("插件，使得小程序也可以监听data数据的变化，做出相应响应，效果和vue的"),s("code",[t._v("computed")]),t._v("类似。")])])},[],!1,null,null,null);v.options.__file="global.md";a.default=v.exports}}]);